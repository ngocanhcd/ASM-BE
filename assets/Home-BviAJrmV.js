import{_ as B,u as _,c as b,r as $,a as i,o as n,b as t,t as c,d,e as N,f as D,g as k,w,h,i as V,j as A,v as L,F as P,k as T,l as E}from"./index-BQ-V0sSv.js";import{p as C}from"./posts-DlvU_W3w.js";const K={class:"card h-100"},j=["src","alt"],H={key:1,class:"card-img-top bg-gradient d-flex align-items-center justify-content-center"},U={class:"card-body d-flex flex-column"},q={class:"card-title"},F={class:"card-text flex-grow-1"},I={class:"post-meta"},M={class:"d-flex gap-2 mt-3"},S={__name:"PostCard",props:{post:{type:Object,required:!0},commentCount:{type:Number,default:0}},emits:["delete"],setup(o){const a=o,{currentUser:u}=_(),r=b(()=>a.post.content.length>150?a.post.content.substring(0,150)+"...":a.post.content),g=b(()=>a.post.authorName||"Unknown"),f=b(()=>new Date(a.post.createdAt).toLocaleDateString("vi-VN",{year:"numeric",month:"long",day:"numeric"})),m=b(()=>u.value&&u.value.id===a.post.authorId);return(p,s)=>{const y=$("router-link");return n(),i("div",K,[o.post.image?(n(),i("img",{key:0,src:o.post.image,class:"card-img-top",alt:o.post.title},null,8,j)):(n(),i("div",H,[...s[1]||(s[1]=[t("i",{class:"bi bi-image",style:{"font-size":"3rem",color:"white"}},null,-1)])])),t("div",U,[t("h5",q,c(o.post.title),1),t("p",F,c(r.value),1),t("div",I,[t("span",null,[s[2]||(s[2]=t("i",{class:"bi bi-person"},null,-1)),d(" "+c(g.value),1)]),t("span",null,[s[3]||(s[3]=t("i",{class:"bi bi-calendar"},null,-1)),d(" "+c(f.value),1)]),t("span",null,[s[4]||(s[4]=t("i",{class:"bi bi-chat"},null,-1)),d(" "+c(o.commentCount)+" bình luận ",1)])]),t("div",M,[N(y,{to:`/posts/${o.post.id}`,class:"btn btn-primary flex-grow-1"},{default:w(()=>[...s[5]||(s[5]=[t("i",{class:"bi bi-eye me-1"},null,-1),d(" Xem chi tiết ",-1)])]),_:1},8,["to"]),m.value?(n(),D(y,{key:0,to:`/posts/${o.post.id}/edit`,class:"btn btn-outline-primary"},{default:w(()=>[...s[6]||(s[6]=[t("i",{class:"bi bi-pencil"},null,-1)])]),_:1},8,["to"])):k("",!0),m.value?(n(),i("button",{key:1,onClick:s[0]||(s[0]=l=>p.$emit("delete",o.post.id)),class:"btn btn-outline-danger"},[...s[7]||(s[7]=[t("i",{class:"bi bi-trash"},null,-1)])])):k("",!0)])])])}}},z=B(S,[["__scopeId","data-v-c9f66faf"]]),O={class:"container"},Q={class:"page-container fade-in"},X={class:"row mb-4"},G={class:"col-md-8 mx-auto"},J={class:"input-group"},R={key:0,class:"row g-4"},W={key:1,class:"empty-state"},tt={__name:"Home",setup(o){const{isAuthenticated:a}=_(),u=h([]),r=h(""),g=h(!1),f=h(""),m=b(()=>{if(!r.value)return u.value;const l=r.value.toLowerCase();return u.value.filter(e=>e.title.toLowerCase().includes(l)||e.content.toLowerCase().includes(l))}),p=async()=>{g.value=!0,f.value="";try{u.value=await C.getAll()}catch(l){f.value="Không thể tải bài viết",console.error("Error loading posts:",l)}finally{g.value=!1}},s=l=>{const e=u.value.find(x=>x.id===l);return(e==null?void 0:e.commentCount)||0},y=async l=>{if(confirm("Bạn có chắc chắn muốn xóa bài viết này?"))try{await C.delete(l),await p()}catch(e){alert("Không thể xóa bài viết"),console.error("Error deleting post:",e)}};return V(()=>{p()}),(l,e)=>{const x=$("router-link");return n(),i("div",O,[t("div",Q,[e[5]||(e[5]=t("div",{class:"text-center mb-5"},[t("h1",{class:"text-gradient mb-3"},[t("i",{class:"bi bi-shop-window me-2"}),d(" Trang Bán Hàng ")]),t("p",{class:"lead text-secondary"},"Khám phá các bài viết và sản phẩm mới nhất")],-1)),t("div",X,[t("div",G,[t("div",J,[e[1]||(e[1]=t("span",{class:"input-group-text"},[t("i",{class:"bi bi-search"})],-1)),A(t("input",{type:"text",class:"form-control","onUpdate:modelValue":e[0]||(e[0]=v=>r.value=v),placeholder:"Tìm kiếm bài viết..."},null,512),[[L,r.value]])])])]),m.value.length>0?(n(),i("div",R,[(n(!0),i(P,null,T(m.value,v=>(n(),i("div",{key:v.id,class:"col-md-6 col-lg-4"},[N(z,{post:v,"comment-count":s(v.id),onDelete:y},null,8,["post","comment-count"])]))),128))])):(n(),i("div",W,[e[3]||(e[3]=t("i",{class:"bi bi-inbox"},null,-1)),e[4]||(e[4]=t("h3",null,"Chưa có bài viết nào",-1)),t("p",null,c(r.value?"Không tìm thấy bài viết phù hợp":"Hãy là người đầu tiên đăng bài!"),1),E(a)&&!r.value?(n(),D(x,{key:0,to:"/posts/create",class:"btn btn-primary"},{default:w(()=>[...e[2]||(e[2]=[t("i",{class:"bi bi-plus-circle me-2"},null,-1),d(" Tạo bài viết đầu tiên ",-1)])]),_:1})):k("",!0)]))])])}}};export{tt as default};
