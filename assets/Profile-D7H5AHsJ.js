import{u as V,i as c,c as U,j as M,a as b,b as p,d as a,h,e as r,t as g,n as P,k as o,v as u,f as N,w as B,r as C,o as f}from"./index-CP0IisnE.js";const D={class:"container"},I={class:"row justify-content-center"},_={class:"col-lg-8"},A={class:"page-container fade-in"},S={key:0,class:"alert alert-danger",role:"alert"},T={key:1,class:"alert alert-success",role:"alert"},j={class:"text-center mb-4"},q={class:"position-relative d-inline-block"},z=["src","alt"],E={class:"mb-3"},R={class:"mb-3"},F={class:"mb-3"},H={class:"mb-3"},K={class:"mb-4"},L={class:"d-flex gap-2"},X={__name:"Profile",setup(Q){const{currentUser:v,updateProfile:k}=V(),l=c({name:"",email:"",avatar:""}),t=c({current:"",new:"",confirm:""}),s=c(""),m=c(""),w=U(()=>l.value.avatar?l.value.avatar:`https://ui-avatars.com/api/?name=${l.value.name}&background=6366f1&color=fff&size=120`);M(()=>{if(v.value){const n=b.findById(v.value.id);l.value={name:n.name,email:n.email,avatar:n.avatar||""}}});const y=n=>{const e=n.target.files[0];if(!e)return;if(e.size>1024*1024){s.value="Kích thước avatar phải nhỏ hơn 1MB";return}if(!e.type.startsWith("image/")){s.value="Vui lòng chọn file hình ảnh";return}const d=new FileReader;d.onload=i=>{l.value.avatar=i.target.result},d.readAsDataURL(e)},x=()=>{s.value="",m.value="";try{const n={name:l.value.name,email:l.value.email,avatar:l.value.avatar};if(t.value.current||t.value.new||t.value.confirm){const e=b.findById(v.value.id);if(!t.value.current){s.value="Vui lòng nhập mật khẩu hiện tại";return}if(e.password!==t.value.current){s.value="Mật khẩu hiện tại không đúng";return}if(!t.value.new){s.value="Vui lòng nhập mật khẩu mới";return}if(t.value.new.length<6){s.value="Mật khẩu mới phải có ít nhất 6 ký tự";return}if(t.value.new!==t.value.confirm){s.value="Mật khẩu xác nhận không khớp";return}n.password=t.value.new}k(n),m.value="Cập nhật thông tin thành công!",t.value={current:"",new:"",confirm:""}}catch(n){s.value=n.message}};return(n,e)=>{const d=C("router-link");return f(),p("div",D,[a("div",I,[a("div",_,[a("div",A,[e[18]||(e[18]=a("h2",{class:"text-gradient mb-4"},[a("i",{class:"bi bi-person-circle me-2"}),r(" Thông tin cá nhân ")],-1)),s.value?(f(),p("div",S,[e[5]||(e[5]=a("i",{class:"bi bi-exclamation-triangle me-2"},null,-1)),r(" "+g(s.value),1)])):h("",!0),m.value?(f(),p("div",T,[e[6]||(e[6]=a("i",{class:"bi bi-check-circle me-2"},null,-1)),r(" "+g(m.value),1)])):h("",!0),a("div",j,[a("div",q,[a("img",{src:w.value,alt:l.value.name,class:"avatar avatar-lg shadow"},null,8,z),e[7]||(e[7]=a("label",{for:"avatarInput",class:"position-absolute bottom-0 end-0 btn btn-sm btn-primary rounded-circle",style:{width:"40px",height:"40px",padding:"0"}},[a("i",{class:"bi bi-camera"})],-1)),a("input",{type:"file",id:"avatarInput",class:"d-none",onChange:y,accept:"image/*"},null,32)])]),a("form",{onSubmit:P(x,["prevent"])},[a("div",E,[e[8]||(e[8]=a("label",{for:"name",class:"form-label"},[a("i",{class:"bi bi-person me-1"}),r(" Họ và tên ")],-1)),o(a("input",{type:"text",class:"form-control",id:"name","onUpdate:modelValue":e[0]||(e[0]=i=>l.value.name=i),required:"",minlength:"3"},null,512),[[u,l.value.name]])]),a("div",R,[e[9]||(e[9]=a("label",{for:"email",class:"form-label"},[a("i",{class:"bi bi-envelope me-1"}),r(" Email ")],-1)),o(a("input",{type:"email",class:"form-control",id:"email","onUpdate:modelValue":e[1]||(e[1]=i=>l.value.email=i),required:""},null,512),[[u,l.value.email]])]),e[15]||(e[15]=a("hr",{class:"my-4"},null,-1)),e[16]||(e[16]=a("h5",{class:"mb-3"},[a("i",{class:"bi bi-key me-2"}),r(" Đổi mật khẩu ")],-1)),e[17]||(e[17]=a("p",{class:"text-secondary small"},"Để trống nếu không muốn thay đổi mật khẩu",-1)),a("div",F,[e[10]||(e[10]=a("label",{for:"currentPassword",class:"form-label"},[a("i",{class:"bi bi-lock me-1"}),r(" Mật khẩu hiện tại ")],-1)),o(a("input",{type:"password",class:"form-control",id:"currentPassword","onUpdate:modelValue":e[2]||(e[2]=i=>t.value.current=i),placeholder:"Nhập mật khẩu hiện tại"},null,512),[[u,t.value.current]])]),a("div",H,[e[11]||(e[11]=a("label",{for:"newPassword",class:"form-label"},[a("i",{class:"bi bi-lock-fill me-1"}),r(" Mật khẩu mới ")],-1)),o(a("input",{type:"password",class:"form-control",id:"newPassword","onUpdate:modelValue":e[3]||(e[3]=i=>t.value.new=i),placeholder:"Nhập mật khẩu mới (tối thiểu 6 ký tự)",minlength:"6"},null,512),[[u,t.value.new]])]),a("div",K,[e[12]||(e[12]=a("label",{for:"confirmPassword",class:"form-label"},[a("i",{class:"bi bi-lock-fill me-1"}),r(" Xác nhận mật khẩu mới ")],-1)),o(a("input",{type:"password",class:"form-control",id:"confirmPassword","onUpdate:modelValue":e[4]||(e[4]=i=>t.value.confirm=i),placeholder:"Nhập lại mật khẩu mới"},null,512),[[u,t.value.confirm]])]),a("div",L,[e[14]||(e[14]=a("button",{type:"submit",class:"btn btn-primary px-4"},[a("i",{class:"bi bi-check-circle me-2"}),r(" Cập nhật thông tin ")],-1)),N(d,{to:"/",class:"btn btn-outline-secondary px-4"},{default:B(()=>[...e[13]||(e[13]=[a("i",{class:"bi bi-arrow-left me-2"},null,-1),r(" Quay lại ",-1)])]),_:1})])],32)])])])])}}};export{X as default};
