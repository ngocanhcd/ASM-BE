import{u as x,h as v,c as V,i as U,a as p,b as a,g as f,d as s,t as h,m as P,j as u,v as m,e as N,w as C,r as M,o as b}from"./index-DoGX8M6O.js";const D={class:"container"},B={class:"row justify-content-center"},_={class:"col-lg-8"},A={class:"page-container fade-in"},T={key:0,class:"alert alert-danger",role:"alert"},j={key:1,class:"alert alert-success",role:"alert"},q={class:"text-center mb-4"},z={class:"position-relative d-inline-block"},E=["src","alt"],I={class:"mb-3"},R={class:"mb-3"},S={class:"mb-3"},F={class:"mb-3"},H={class:"mb-4"},K={class:"d-flex gap-2"},W={__name:"Profile",setup(L){const{currentUser:o,updateProfile:g}=x(),t=v({name:"",email:"",avatar:""}),n=v({current:"",new:"",confirm:""}),i=v(""),d=v(""),w=V(()=>t.value.avatar?t.value.avatar:`https://ui-avatars.com/api/?name=${t.value.name}&background=6366f1&color=fff&size=120`);U(()=>{o.value&&(t.value={name:o.value.fullName||o.value.name||"",email:o.value.email||"",avatar:o.value.avatar||""})});const k=r=>{const e=r.target.files[0];if(!e)return;if(e.size>1024*1024){i.value="Kích thước avatar phải nhỏ hơn 1MB";return}if(!e.type.startsWith("image/")){i.value="Vui lòng chọn file hình ảnh";return}const c=new FileReader;c.onload=l=>{t.value.avatar=l.target.result},c.readAsDataURL(e)},y=()=>{i.value="",d.value="";try{const r={name:t.value.name,email:t.value.email,avatar:t.value.avatar};if(n.value.current||n.value.new||n.value.confirm){i.value="Đổi mật khẩu chưa được hỗ trợ. Vui lòng chỉ cập nhật thông tin cá nhân.";return}g(r),d.value="Cập nhật thông tin thành công!",n.value={current:"",new:"",confirm:""}}catch(r){i.value=r.message}};return(r,e)=>{const c=M("router-link");return b(),p("div",D,[a("div",B,[a("div",_,[a("div",A,[e[18]||(e[18]=a("h2",{class:"text-gradient mb-4"},[a("i",{class:"bi bi-person-circle me-2"}),s(" Thông tin cá nhân ")],-1)),i.value?(b(),p("div",T,[e[5]||(e[5]=a("i",{class:"bi bi-exclamation-triangle me-2"},null,-1)),s(" "+h(i.value),1)])):f("",!0),d.value?(b(),p("div",j,[e[6]||(e[6]=a("i",{class:"bi bi-check-circle me-2"},null,-1)),s(" "+h(d.value),1)])):f("",!0),a("div",q,[a("div",z,[a("img",{src:w.value,alt:t.value.name,class:"avatar avatar-lg shadow"},null,8,E),e[7]||(e[7]=a("label",{for:"avatarInput",class:"position-absolute bottom-0 end-0 btn btn-sm btn-primary rounded-circle",style:{width:"40px",height:"40px",padding:"0"}},[a("i",{class:"bi bi-camera"})],-1)),a("input",{type:"file",id:"avatarInput",class:"d-none",onChange:k,accept:"image/*"},null,32)])]),a("form",{onSubmit:P(y,["prevent"])},[a("div",I,[e[8]||(e[8]=a("label",{for:"name",class:"form-label"},[a("i",{class:"bi bi-person me-1"}),s(" Họ và tên ")],-1)),u(a("input",{type:"text",class:"form-control",id:"name","onUpdate:modelValue":e[0]||(e[0]=l=>t.value.name=l),required:"",minlength:"3"},null,512),[[m,t.value.name]])]),a("div",R,[e[9]||(e[9]=a("label",{for:"email",class:"form-label"},[a("i",{class:"bi bi-envelope me-1"}),s(" Email ")],-1)),u(a("input",{type:"email",class:"form-control",id:"email","onUpdate:modelValue":e[1]||(e[1]=l=>t.value.email=l),required:""},null,512),[[m,t.value.email]])]),e[15]||(e[15]=a("hr",{class:"my-4"},null,-1)),e[16]||(e[16]=a("h5",{class:"mb-3"},[a("i",{class:"bi bi-key me-2"}),s(" Đổi mật khẩu ")],-1)),e[17]||(e[17]=a("p",{class:"text-secondary small"},"Để trống nếu không muốn thay đổi mật khẩu",-1)),a("div",S,[e[10]||(e[10]=a("label",{for:"currentPassword",class:"form-label"},[a("i",{class:"bi bi-lock me-1"}),s(" Mật khẩu hiện tại ")],-1)),u(a("input",{type:"password",class:"form-control",id:"currentPassword","onUpdate:modelValue":e[2]||(e[2]=l=>n.value.current=l),placeholder:"Nhập mật khẩu hiện tại"},null,512),[[m,n.value.current]])]),a("div",F,[e[11]||(e[11]=a("label",{for:"newPassword",class:"form-label"},[a("i",{class:"bi bi-lock-fill me-1"}),s(" Mật khẩu mới ")],-1)),u(a("input",{type:"password",class:"form-control",id:"newPassword","onUpdate:modelValue":e[3]||(e[3]=l=>n.value.new=l),placeholder:"Nhập mật khẩu mới (tối thiểu 6 ký tự)",minlength:"6"},null,512),[[m,n.value.new]])]),a("div",H,[e[12]||(e[12]=a("label",{for:"confirmPassword",class:"form-label"},[a("i",{class:"bi bi-lock-fill me-1"}),s(" Xác nhận mật khẩu mới ")],-1)),u(a("input",{type:"password",class:"form-control",id:"confirmPassword","onUpdate:modelValue":e[4]||(e[4]=l=>n.value.confirm=l),placeholder:"Nhập lại mật khẩu mới"},null,512),[[m,n.value.confirm]])]),a("div",K,[e[14]||(e[14]=a("button",{type:"submit",class:"btn btn-primary px-4"},[a("i",{class:"bi bi-check-circle me-2"}),s(" Cập nhật thông tin ")],-1)),N(c,{to:"/",class:"btn btn-outline-secondary px-4"},{default:C(()=>[...e[13]||(e[13]=[a("i",{class:"bi bi-arrow-left me-2"},null,-1),s(" Quay lại ",-1)])]),_:1})])],32)])])])])}}};export{W as default};
