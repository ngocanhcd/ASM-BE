import{_ as N,u as _,c as b,a as V,r as $,b as a,o as n,d as t,t as d,e as m,f as B,g as D,h as k,w,i as h,j as A,k as L,v as P,F as T,l as E,m as I}from"./index-BGZUegoZ.js";import{p as C}from"./posts-BluE-9qV.js";const K={class:"card h-100"},j=["src","alt"],H={key:1,class:"card-img-top bg-gradient d-flex align-items-center justify-content-center"},S={class:"card-body d-flex flex-column"},U={class:"card-title"},q={class:"card-text flex-grow-1"},F={class:"post-meta"},M={class:"d-flex gap-2 mt-3"},z={__name:"PostCard",props:{post:{type:Object,required:!0},commentCount:{type:Number,default:0}},emits:["delete"],setup(o){const r=o,{currentUser:c}=_(),u=b(()=>r.post.content.length>150?r.post.content.substring(0,150)+"...":r.post.content),g=b(()=>{const i=V.findById(r.post.authorId);return(i==null?void 0:i.name)||"Unknown"}),f=b(()=>new Date(r.post.createdAt).toLocaleDateString("vi-VN",{year:"numeric",month:"long",day:"numeric"})),p=b(()=>c.value&&c.value.id===r.post.authorId);return(i,s)=>{const y=$("router-link");return n(),a("div",K,[o.post.image?(n(),a("img",{key:0,src:o.post.image,class:"card-img-top",alt:o.post.title},null,8,j)):(n(),a("div",H,[...s[1]||(s[1]=[t("i",{class:"bi bi-image",style:{"font-size":"3rem",color:"white"}},null,-1)])])),t("div",S,[t("h5",U,d(o.post.title),1),t("p",q,d(u.value),1),t("div",F,[t("span",null,[s[2]||(s[2]=t("i",{class:"bi bi-person"},null,-1)),m(" "+d(g.value),1)]),t("span",null,[s[3]||(s[3]=t("i",{class:"bi bi-calendar"},null,-1)),m(" "+d(f.value),1)]),t("span",null,[s[4]||(s[4]=t("i",{class:"bi bi-chat"},null,-1)),m(" "+d(o.commentCount)+" bình luận ",1)])]),t("div",M,[B(y,{to:`/posts/${o.post.id}`,class:"btn btn-primary flex-grow-1"},{default:w(()=>[...s[5]||(s[5]=[t("i",{class:"bi bi-eye me-1"},null,-1),m(" Xem chi tiết ",-1)])]),_:1},8,["to"]),p.value?(n(),D(y,{key:0,to:`/posts/${o.post.id}/edit`,class:"btn btn-outline-primary"},{default:w(()=>[...s[6]||(s[6]=[t("i",{class:"bi bi-pencil"},null,-1)])]),_:1},8,["to"])):k("",!0),p.value?(n(),a("button",{key:1,onClick:s[0]||(s[0]=l=>i.$emit("delete",o.post.id)),class:"btn btn-outline-danger"},[...s[7]||(s[7]=[t("i",{class:"bi bi-trash"},null,-1)])])):k("",!0)])])])}}},O=N(z,[["__scopeId","data-v-c4b24f38"]]),Q={class:"container"},X={class:"page-container fade-in"},G={class:"row mb-4"},J={class:"col-md-8 mx-auto"},R={class:"input-group"},W={key:0,class:"row g-4"},Y={key:1,class:"empty-state"},et={__name:"Home",setup(o){const{isAuthenticated:r}=_(),c=h([]),u=h(""),g=h(!1),f=h(""),p=b(()=>{if(!u.value)return c.value;const l=u.value.toLowerCase();return c.value.filter(e=>e.title.toLowerCase().includes(l)||e.content.toLowerCase().includes(l))}),i=async()=>{g.value=!0,f.value="";try{c.value=await C.getAll()}catch(l){f.value="Không thể tải bài viết",console.error("Error loading posts:",l)}finally{g.value=!1}},s=l=>{const e=c.value.find(x=>x.id===l);return(e==null?void 0:e.commentCount)||0},y=async l=>{if(confirm("Bạn có chắc chắn muốn xóa bài viết này?"))try{await C.delete(l),await i()}catch(e){alert("Không thể xóa bài viết"),console.error("Error deleting post:",e)}};return A(()=>{i()}),(l,e)=>{const x=$("router-link");return n(),a("div",Q,[t("div",X,[e[5]||(e[5]=t("div",{class:"text-center mb-5"},[t("h1",{class:"text-gradient mb-3"},[t("i",{class:"bi bi-shop-window me-2"}),m(" Trang Bán Hàng ")]),t("p",{class:"lead text-secondary"},"Khám phá các bài viết và sản phẩm mới nhất")],-1)),t("div",G,[t("div",J,[t("div",R,[e[1]||(e[1]=t("span",{class:"input-group-text"},[t("i",{class:"bi bi-search"})],-1)),L(t("input",{type:"text",class:"form-control","onUpdate:modelValue":e[0]||(e[0]=v=>u.value=v),placeholder:"Tìm kiếm bài viết..."},null,512),[[P,u.value]])])])]),p.value.length>0?(n(),a("div",W,[(n(!0),a(T,null,E(p.value,v=>(n(),a("div",{key:v.id,class:"col-md-6 col-lg-4"},[B(O,{post:v,"comment-count":s(v.id),onDelete:y},null,8,["post","comment-count"])]))),128))])):(n(),a("div",Y,[e[3]||(e[3]=t("i",{class:"bi bi-inbox"},null,-1)),e[4]||(e[4]=t("h3",null,"Chưa có bài viết nào",-1)),t("p",null,d(u.value?"Không tìm thấy bài viết phù hợp":"Hãy là người đầu tiên đăng bài!"),1),I(r)&&!u.value?(n(),D(x,{key:0,to:"/posts/create",class:"btn btn-primary"},{default:w(()=>[...e[2]||(e[2]=[t("i",{class:"bi bi-plus-circle me-2"},null,-1),m(" Tạo bài viết đầu tiên ",-1)])]),_:1})):k("",!0)]))])])}}};export{et as default};
